(window["webpackJsonp_yves_default"] = window["webpackJsonp_yves_default"] || []).push([["company-business-unit-address-handler"],{

/***/ "./vendor/spryker-shop/company-widget/src/SprykerShop/Yves/CompanyWidget/Theme/default/components/molecules/company-business-unit-address-handler/company-business-unit-address-handler.ts":
/*!*************************************************************************************************************************************************************************************************!*\
  !*** ./vendor/spryker-shop/company-widget/src/SprykerShop/Yves/CompanyWidget/Theme/default/components/molecules/company-business-unit-address-handler/company-business-unit-address-handler.ts ***!
  \*************************************************************************************************************************************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "default", function() { return CompanyBusinessUnitAddressHandler; });
/* harmony import */ var ShopUi_models_component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ShopUi/models/component */ "./vendor/spryker-shop/shop-ui/src/SprykerShop/Yves/ShopUi/Theme/default/models/component.ts");

var EVENT_HIDDEN_ADDRESS_INPUT_CHANGE = 'hidden-address-input-change';
/**
 * @event hidden-address-input-change An event which is triggered after the new address are selected.
 */

class CompanyBusinessUnitAddressHandler extends ShopUi_models_component__WEBPACK_IMPORTED_MODULE_0__["default"] {
  constructor() {
    super(...arguments);
    this.form = void 0;
    this.addressesDataObject = void 0;
    this.addressesSelects = void 0;
    this.currentAddress = void 0;
    this.hiddenDefaultAddressInput = void 0;
    this.hiddenAddressInputChangeEvent = void 0;
    this.shippingAddressToggler = void 0;
  }

  readyCallback() {
    this.form = document.querySelector(this.formSelector);
    this.addressesSelects = Array.from(this.form.querySelectorAll(this.dataSelector));
    this.hiddenDefaultAddressInput = this.form.querySelector(this.defaultAddressSelector);

    if (this.shippingAddressTogglerSelector) {
      this.shippingAddressToggler = document.querySelector(this.shippingAddressTogglerSelector);
    }

    this.initAddressesData();
    this.mapEvents();
    this.initHiddenAddressInputChangeEvent();
    this.fillDefaultAddress();

    if (this.shippingAddressToggler) {
      this.toggleSplitDeliveryAddressFormValue();
    }
  }

  mapEvents() {
    this.addressesSelects.forEach(selectElement => {
      selectElement.addEventListener('change', () => {
        this.setCurrentAddress(selectElement);
        this.fillHiddenInputsWithNewAddress();
      });
    });

    if (this.shippingAddressToggler) {
      this.shippingAddressToggler.addEventListener('change', () => {
        this.toggleSplitDeliveryAddressFormValue();
      });
    }
  }

  initHiddenAddressInputChangeEvent() {
    this.hiddenAddressInputChangeEvent = new CustomEvent(EVENT_HIDDEN_ADDRESS_INPUT_CHANGE);
    this.hiddenAddressInputChangeEvent.initEvent('change', true, true);
  }

  toggleSplitDeliveryAddressFormValue() {
    var hiddenInputIdCustomerShippingAddress = document.querySelector(this.shippingAddressHiddenInputSelector);
    var hiddenInputIdCompanyShippingAddress = document.querySelector(this.shippingCompanyAddressHiddenInputSelector);

    if (this.shippingAddressToggler.value === this.optionValueDeliverToMultipleAddresses) {
      hiddenInputIdCustomerShippingAddress.value = this.optionValueDeliverToMultipleAddresses;
      hiddenInputIdCompanyShippingAddress.value = this.optionValueDeliverToMultipleAddresses;
    }
  }

  setCurrentAddress(selectElement) {
    this.currentAddress = selectElement.options[selectElement.selectedIndex].getAttribute('value');
  }

  fillHiddenInputsWithNewAddress() {
    var currentAddressList = this.addressesDataObject[this.currentAddress];
    var hiddenInputIdCustomerAddress = this.form.querySelector(this.addressHiddenInputSelector);
    var hiddenInputIdCompanyAddress = this.form.querySelector(this.companyAddressHiddenInputSelector);
    this.hiddenDefaultAddressInput.value = this.currentAddress;
    this.fillHiddenInputAddressesFields(currentAddressList, this.addressHiddenInputSelector, 'id_customer_address');
    this.fillHiddenInputAddressesFields(currentAddressList, this.companyAddressHiddenInputSelector, 'id_company_unit_address');
    hiddenInputIdCustomerAddress.dispatchEvent(this.hiddenAddressInputChangeEvent);
    hiddenInputIdCompanyAddress.dispatchEvent(this.hiddenAddressInputChangeEvent);
  }

  fillDefaultAddress() {
    var hiddenDefaultAddressInputValue = this.hiddenDefaultAddressInput.getAttribute('value');

    if (hiddenDefaultAddressInputValue) {
      this.currentAddress = hiddenDefaultAddressInputValue;
      this.fillHiddenInputsWithNewAddress();
    }
  }
  /**
   * Fills the form element's value with an address value.
   * @param address A data object for filling the fields.
   */


  fillHiddenInputAddressesFields(address, selector, idAddressKey) {
    var hiddenInputIdAddress = this.form.querySelector(selector);
    hiddenInputIdAddress.value = address ? address[idAddressKey] : '';
  }

  initAddressesData() {
    var data = this.getAttribute('addresses');
    this.addressesDataObject = JSON.parse(data);
  }
  /**
   * Gets a querySelector name of the form element.
   */


  get formSelector() {
    return this.getAttribute('form-selector');
  }
  /**
   * Gets a querySelector name of the address select elements.
   */


  get dataSelector() {
    return this.getAttribute('data-selector');
  }
  /**
   * Gets a querySelector name of a hidden default address input.
   */


  get defaultAddressSelector() {
    return this.getAttribute('default-address-selector');
  }
  /**
   * Gets a querySelector name of a hidden customer id input.
   */


  get addressHiddenInputSelector() {
    return this.getAttribute('address-hidden-input-selector');
  }
  /**
   * Gets a querySelector name of a hidden company unit id input.
   */


  get companyAddressHiddenInputSelector() {
    return this.getAttribute('company-address-hidden-input-selector');
  }
  /**
   * Gets a querySelector name of a hidden shipping customer id input.
   */


  get shippingAddressHiddenInputSelector() {
    return this.getAttribute('shipping-address-hidden-input-selector');
  }
  /**
   * Gets a querySelector name of a hidden shipping customer id input.
   */


  get shippingCompanyAddressHiddenInputSelector() {
    return this.getAttribute('shipping-company-address-hidden-input-selector');
  }
  /**
   * Gets if the split delivery form is defined.
   */


  get optionValueDeliverToMultipleAddresses() {
    return this.getAttribute('toggle-option-value');
  }
  /**
   * Gets a querySelector name of the shipping address select element.
   */


  get shippingAddressTogglerSelector() {
    return this.getAttribute('shipping-address-toggler-selector');
  }

}

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi92ZW5kb3Ivc3ByeWtlci1zaG9wL2NvbXBhbnktd2lkZ2V0L3NyYy9TcHJ5a2VyU2hvcC9ZdmVzL0NvbXBhbnlXaWRnZXQvVGhlbWUvZGVmYXVsdC9jb21wb25lbnRzL21vbGVjdWxlcy9jb21wYW55LWJ1c2luZXNzLXVuaXQtYWRkcmVzcy1oYW5kbGVyL2NvbXBhbnktYnVzaW5lc3MtdW5pdC1hZGRyZXNzLWhhbmRsZXIudHMiXSwibmFtZXMiOlsiRVZFTlRfSElEREVOX0FERFJFU1NfSU5QVVRfQ0hBTkdFIiwiQ29tcGFueUJ1c2luZXNzVW5pdEFkZHJlc3NIYW5kbGVyIiwiQ29tcG9uZW50IiwiZm9ybSIsImFkZHJlc3Nlc0RhdGFPYmplY3QiLCJhZGRyZXNzZXNTZWxlY3RzIiwiY3VycmVudEFkZHJlc3MiLCJoaWRkZW5EZWZhdWx0QWRkcmVzc0lucHV0IiwiaGlkZGVuQWRkcmVzc0lucHV0Q2hhbmdlRXZlbnQiLCJzaGlwcGluZ0FkZHJlc3NUb2dnbGVyIiwicmVhZHlDYWxsYmFjayIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImZvcm1TZWxlY3RvciIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJkYXRhU2VsZWN0b3IiLCJkZWZhdWx0QWRkcmVzc1NlbGVjdG9yIiwic2hpcHBpbmdBZGRyZXNzVG9nZ2xlclNlbGVjdG9yIiwiaW5pdEFkZHJlc3Nlc0RhdGEiLCJtYXBFdmVudHMiLCJpbml0SGlkZGVuQWRkcmVzc0lucHV0Q2hhbmdlRXZlbnQiLCJmaWxsRGVmYXVsdEFkZHJlc3MiLCJ0b2dnbGVTcGxpdERlbGl2ZXJ5QWRkcmVzc0Zvcm1WYWx1ZSIsImZvckVhY2giLCJzZWxlY3RFbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsInNldEN1cnJlbnRBZGRyZXNzIiwiZmlsbEhpZGRlbklucHV0c1dpdGhOZXdBZGRyZXNzIiwiQ3VzdG9tRXZlbnQiLCJpbml0RXZlbnQiLCJoaWRkZW5JbnB1dElkQ3VzdG9tZXJTaGlwcGluZ0FkZHJlc3MiLCJzaGlwcGluZ0FkZHJlc3NIaWRkZW5JbnB1dFNlbGVjdG9yIiwiaGlkZGVuSW5wdXRJZENvbXBhbnlTaGlwcGluZ0FkZHJlc3MiLCJzaGlwcGluZ0NvbXBhbnlBZGRyZXNzSGlkZGVuSW5wdXRTZWxlY3RvciIsInZhbHVlIiwib3B0aW9uVmFsdWVEZWxpdmVyVG9NdWx0aXBsZUFkZHJlc3NlcyIsIm9wdGlvbnMiLCJzZWxlY3RlZEluZGV4IiwiZ2V0QXR0cmlidXRlIiwiY3VycmVudEFkZHJlc3NMaXN0IiwiaGlkZGVuSW5wdXRJZEN1c3RvbWVyQWRkcmVzcyIsImFkZHJlc3NIaWRkZW5JbnB1dFNlbGVjdG9yIiwiaGlkZGVuSW5wdXRJZENvbXBhbnlBZGRyZXNzIiwiY29tcGFueUFkZHJlc3NIaWRkZW5JbnB1dFNlbGVjdG9yIiwiZmlsbEhpZGRlbklucHV0QWRkcmVzc2VzRmllbGRzIiwiZGlzcGF0Y2hFdmVudCIsImhpZGRlbkRlZmF1bHRBZGRyZXNzSW5wdXRWYWx1ZSIsImFkZHJlc3MiLCJzZWxlY3RvciIsImlkQWRkcmVzc0tleSIsImhpZGRlbklucHV0SWRBZGRyZXNzIiwiZGF0YSIsIkpTT04iLCJwYXJzZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUEsSUFBTUEsaUNBQWlDLEdBQUcsNkJBQTFDO0FBQ0E7QUFDQTtBQUNBOztBQUNlLE1BQU1DLGlDQUFOLFNBQWdEQywrREFBaEQsQ0FBMEQ7QUFBQTtBQUFBO0FBQUEsU0FJckVDLElBSnFFO0FBQUEsU0FTckVDLG1CQVRxRTtBQUFBLFNBY3JFQyxnQkFkcUU7QUFBQSxTQWtCckVDLGNBbEJxRTtBQUFBLFNBc0JyRUMseUJBdEJxRTtBQUFBLFNBMEJyRUMsNkJBMUJxRTtBQUFBLFNBOEJyRUMsc0JBOUJxRTtBQUFBOztBQWdDM0RDLGVBQWEsR0FBUztBQUM1QixTQUFLUCxJQUFMLEdBQTZCUSxRQUFRLENBQUNDLGFBQVQsQ0FBdUIsS0FBS0MsWUFBNUIsQ0FB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QUFqQ0ssaUNBQWlDLEdBQVc7QUFDNUMsV0FBTyxLQUFLTCxZQUFMLENBQWtCLHVDQUFsQixDQUFQO0FBQ0g7QUFFRDtBQUNKO0FBQ0E7OztBQUMwQyxNQUFsQ1Asa0NBQWtDLEdBQVc7QUFDN0MsV0FBTyxLQUFLTyxZQUFMLENBQWtCLHdDQUFsQixDQUFQO0FBQ0g7QUFFRDtBQUNKO0FBQ0E7OztBQUNpRCxNQUF6Q0wseUNBQXlDLEdBQVc7QUFDcEQsV0FBTyxLQUFLSyxZQUFMLENBQWtCLGdEQUFsQixDQUFQO0FBQ0g7QUFFRDtBQUNKO0FBQ0E7OztBQUM2QyxNQUFyQ0gscUNBQXFDLEdBQVc7QUFDaEQsV0FBTyxLQUFLRyxZQUFMLENBQWtCLHFCQUFsQixDQUFQO0FBQ0g7QUFFRDtBQUNKO0FBQ0E7OztBQUNzQyxNQUE5QnJCLDhCQUE4QixHQUFXO0FBQ3pDLFdBQU8sS0FBS3FCLFlBQUwsQ0FBa0IsbUNBQWxCLENBQVA7QUFDSDs7QUExTG9FLEMiLCJmaWxlIjoiLi9qcy95dmVzX2RlZmF1bHQuY29tcGFueS1idXNpbmVzcy11bml0LWFkZHJlc3MtaGFuZGxlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDb21wb25lbnQgZnJvbSAnU2hvcFVpL21vZGVscy9jb21wb25lbnQnO1xuXG5jb25zdCBFVkVOVF9ISURERU5fQUREUkVTU19JTlBVVF9DSEFOR0UgPSAnaGlkZGVuLWFkZHJlc3MtaW5wdXQtY2hhbmdlJztcbi8qKlxuICogQGV2ZW50IGhpZGRlbi1hZGRyZXNzLWlucHV0LWNoYW5nZSBBbiBldmVudCB3aGljaCBpcyB0cmlnZ2VyZWQgYWZ0ZXIgdGhlIG5ldyBhZGRyZXNzIGFyZSBzZWxlY3RlZC5cbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29tcGFueUJ1c2luZXNzVW5pdEFkZHJlc3NIYW5kbGVyIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgICAvKipcbiAgICAgKiBUaGUgY3VycmVudCBmb3JtLlxuICAgICAqL1xuICAgIGZvcm06IEhUTUxGb3JtRWxlbWVudDtcbiAgICAvKipcbiAgICAgKiBEYXRhIG9iamVjdCBvZiB0aGUgYWRkcmVzcyBsaXN0LlxuICAgICAqL1xuICAgIC8qIHRzbGludDpkaXNhYmxlOm5vLWFueSAqL1xuICAgIGFkZHJlc3Nlc0RhdGFPYmplY3Q6IGFueTtcbiAgICAvKiB0c2xpbnQ6ZW5hYmxlOm5vLWFueSAqL1xuICAgIC8qKlxuICAgICAqIENvbGxlY3Rpb24gb2YgdGhlIGFkZHJlc3Mgc2VsZWN0IGVsZW1lbnRzLlxuICAgICAqL1xuICAgIGFkZHJlc3Nlc1NlbGVjdHM6IEhUTUxTZWxlY3RFbGVtZW50W107XG4gICAgLyoqXG4gICAgICogVGhlIHNlbGVjdGVkIGFkZHJlc3MuXG4gICAgICovXG4gICAgY3VycmVudEFkZHJlc3M6IHN0cmluZztcbiAgICAvKipcbiAgICAgKiBUaGUgaGlkZGVuIGlucHV0IHdpdGggc2VsZWN0ZWQgYWRkcmVzcyBieSBkZWZhdWx0LlxuICAgICAqL1xuICAgIGhpZGRlbkRlZmF1bHRBZGRyZXNzSW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgLyoqXG4gICAgICogVGhlIGN1c3RvbSBldmVudC5cbiAgICAgKi9cbiAgICBoaWRkZW5BZGRyZXNzSW5wdXRDaGFuZ2VFdmVudDogQ3VzdG9tRXZlbnQ7XG4gICAgLyoqXG4gICAgICogVGhlIHNoaXBwaW5nIGFkZHJlc3Mgc2VsZWN0IGVsZW1lbnQuXG4gICAgICovXG4gICAgc2hpcHBpbmdBZGRyZXNzVG9nZ2xlcjogSFRNTFNlbGVjdEVsZW1lbnQ7XG5cbiAgICBwcm90ZWN0ZWQgcmVhZHlDYWxsYmFjaygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5mb3JtID0gPEhUTUxGb3JtRWxlbWVudD5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuZm9ybVNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5hZGRyZXNzZXNTZWxlY3RzID0gPEhUTUxTZWxlY3RFbGVtZW50W10+QXJyYXkuZnJvbSh0aGlzLmZvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLmRhdGFTZWxlY3RvcikpO1xuICAgICAgICB0aGlzLmhpZGRlbkRlZmF1bHRBZGRyZXNzSW5wdXQgPSA8SFRNTElucHV0RWxlbWVudD50aGlzLmZvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLmRlZmF1bHRBZGRyZXNzU2VsZWN0b3IpO1xuICAgICAgICBpZiAodGhpcy5zaGlwcGluZ0FkZHJlc3NUb2dnbGVyU2VsZWN0b3IpIHtcbiAgICAgICAgICAgIHRoaXMuc2hpcHBpbmdBZGRyZXNzVG9nZ2xlciA9IDxIVE1MU2VsZWN0RWxlbWVudD4oXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLnNoaXBwaW5nQWRkcmVzc1RvZ2dsZXJTZWxlY3RvcilcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbml0QWRkcmVzc2VzRGF0YSgpO1xuICAgICAgICB0aGlzLm1hcEV2ZW50cygpO1xuICAgICAgICB0aGlzLmluaXRIaWRkZW5BZGRyZXNzSW5wdXRDaGFuZ2VFdmVudCgpO1xuICAgICAgICB0aGlzLmZpbGxEZWZhdWx0QWRkcmVzcygpO1xuICAgICAgICBpZiAodGhpcy5zaGlwcGluZ0FkZHJlc3NUb2dnbGVyKSB7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZVNwbGl0RGVsaXZlcnlBZGRyZXNzRm9ybVZhbHVlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgbWFwRXZlbnRzKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmFkZHJlc3Nlc1NlbGVjdHMuZm9yRWFjaCgoc2VsZWN0RWxlbWVudDogSFRNTFNlbGVjdEVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgIHNlbGVjdEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0Q3VycmVudEFkZHJlc3Moc2VsZWN0RWxlbWVudCk7XG4gICAgICAgICAgICAgICAgdGhpcy5maWxsSGlkZGVuSW5wdXRzV2l0aE5ld0FkZHJlc3MoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHRoaXMuc2hpcHBpbmdBZGRyZXNzVG9nZ2xlcikge1xuICAgICAgICAgICAgdGhpcy5zaGlwcGluZ0FkZHJlc3NUb2dnbGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZVNwbGl0RGVsaXZlcnlBZGRyZXNzRm9ybVZhbHVlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByb3RlY3RlZCBpbml0SGlkZGVuQWRkcmVzc0lucHV0Q2hhbmdlRXZlbnQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuaGlkZGVuQWRkcmVzc0lucHV0Q2hhbmdlRXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoRVZFTlRfSElEREVOX0FERFJFU1NfSU5QVVRfQ0hBTkdFKTtcbiAgICAgICAgdGhpcy5oaWRkZW5BZGRyZXNzSW5wdXRDaGFuZ2VFdmVudC5pbml0RXZlbnQoJ2NoYW5nZScsIHRydWUsIHRydWUpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCB0b2dnbGVTcGxpdERlbGl2ZXJ5QWRkcmVzc0Zvcm1WYWx1ZSgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgaGlkZGVuSW5wdXRJZEN1c3RvbWVyU2hpcHBpbmdBZGRyZXNzID0gPEhUTUxJbnB1dEVsZW1lbnQ+KFxuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLnNoaXBwaW5nQWRkcmVzc0hpZGRlbklucHV0U2VsZWN0b3IpXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IGhpZGRlbklucHV0SWRDb21wYW55U2hpcHBpbmdBZGRyZXNzID0gPEhUTUxJbnB1dEVsZW1lbnQ+KFxuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLnNoaXBwaW5nQ29tcGFueUFkZHJlc3NIaWRkZW5JbnB1dFNlbGVjdG9yKVxuICAgICAgICApO1xuICAgICAgICBpZiAodGhpcy5zaGlwcGluZ0FkZHJlc3NUb2dnbGVyLnZhbHVlID09PSB0aGlzLm9wdGlvblZhbHVlRGVsaXZlclRvTXVsdGlwbGVBZGRyZXNzZXMpIHtcbiAgICAgICAgICAgIGhpZGRlbklucHV0SWRDdXN0b21lclNoaXBwaW5nQWRkcmVzcy52YWx1ZSA9IHRoaXMub3B0aW9uVmFsdWVEZWxpdmVyVG9NdWx0aXBsZUFkZHJlc3NlcztcbiAgICAgICAgICAgIGhpZGRlbklucHV0SWRDb21wYW55U2hpcHBpbmdBZGRyZXNzLnZhbHVlID0gdGhpcy5vcHRpb25WYWx1ZURlbGl2ZXJUb011bHRpcGxlQWRkcmVzc2VzO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIHNldEN1cnJlbnRBZGRyZXNzKHNlbGVjdEVsZW1lbnQ6IEhUTUxTZWxlY3RFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIHRoaXMuY3VycmVudEFkZHJlc3MgPSBzZWxlY3RFbGVtZW50Lm9wdGlvbnNbc2VsZWN0RWxlbWVudC5zZWxlY3RlZEluZGV4XS5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJyk7XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGZpbGxIaWRkZW5JbnB1dHNXaXRoTmV3QWRkcmVzcygpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY3VycmVudEFkZHJlc3NMaXN0ID0gdGhpcy5hZGRyZXNzZXNEYXRhT2JqZWN0W3RoaXMuY3VycmVudEFkZHJlc3NdO1xuICAgICAgICBjb25zdCBoaWRkZW5JbnB1dElkQ3VzdG9tZXJBZGRyZXNzID0gPEhUTUxJbnB1dEVsZW1lbnQ+dGhpcy5mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5hZGRyZXNzSGlkZGVuSW5wdXRTZWxlY3Rvcik7XG4gICAgICAgIGNvbnN0IGhpZGRlbklucHV0SWRDb21wYW55QWRkcmVzcyA9IDxIVE1MSW5wdXRFbGVtZW50PihcbiAgICAgICAgICAgIHRoaXMuZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuY29tcGFueUFkZHJlc3NIaWRkZW5JbnB1dFNlbGVjdG9yKVxuICAgICAgICApO1xuICAgICAgICB0aGlzLmhpZGRlbkRlZmF1bHRBZGRyZXNzSW5wdXQudmFsdWUgPSB0aGlzLmN1cnJlbnRBZGRyZXNzO1xuICAgICAgICB0aGlzLmZpbGxIaWRkZW5JbnB1dEFkZHJlc3Nlc0ZpZWxkcyhjdXJyZW50QWRkcmVzc0xpc3QsIHRoaXMuYWRkcmVzc0hpZGRlbklucHV0U2VsZWN0b3IsICdpZF9jdXN0b21lcl9hZGRyZXNzJyk7XG4gICAgICAgIHRoaXMuZmlsbEhpZGRlbklucHV0QWRkcmVzc2VzRmllbGRzKFxuICAgICAgICAgICAgY3VycmVudEFkZHJlc3NMaXN0LFxuICAgICAgICAgICAgdGhpcy5jb21wYW55QWRkcmVzc0hpZGRlbklucHV0U2VsZWN0b3IsXG4gICAgICAgICAgICAnaWRfY29tcGFueV91bml0X2FkZHJlc3MnLFxuICAgICAgICApO1xuICAgICAgICBoaWRkZW5JbnB1dElkQ3VzdG9tZXJBZGRyZXNzLmRpc3BhdGNoRXZlbnQodGhpcy5oaWRkZW5BZGRyZXNzSW5wdXRDaGFuZ2VFdmVudCk7XG4gICAgICAgIGhpZGRlbklucHV0SWRDb21wYW55QWRkcmVzcy5kaXNwYXRjaEV2ZW50KHRoaXMuaGlkZGVuQWRkcmVzc0lucHV0Q2hhbmdlRXZlbnQpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBmaWxsRGVmYXVsdEFkZHJlc3MoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGhpZGRlbkRlZmF1bHRBZGRyZXNzSW5wdXRWYWx1ZSA9IHRoaXMuaGlkZGVuRGVmYXVsdEFkZHJlc3NJbnB1dC5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJyk7XG4gICAgICAgIGlmIChoaWRkZW5EZWZhdWx0QWRkcmVzc0lucHV0VmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEFkZHJlc3MgPSBoaWRkZW5EZWZhdWx0QWRkcmVzc0lucHV0VmFsdWU7XG4gICAgICAgICAgICB0aGlzLmZpbGxIaWRkZW5JbnB1dHNXaXRoTmV3QWRkcmVzcygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmlsbHMgdGhlIGZvcm0gZWxlbWVudCdzIHZhbHVlIHdpdGggYW4gYWRkcmVzcyB2YWx1ZS5cbiAgICAgKiBAcGFyYW0gYWRkcmVzcyBBIGRhdGEgb2JqZWN0IGZvciBmaWxsaW5nIHRoZSBmaWVsZHMuXG4gICAgICovXG4gICAgZmlsbEhpZGRlbklucHV0QWRkcmVzc2VzRmllbGRzKGFkZHJlc3M6IG9iamVjdCwgc2VsZWN0b3I6IHN0cmluZywgaWRBZGRyZXNzS2V5OiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgaGlkZGVuSW5wdXRJZEFkZHJlc3MgPSA8SFRNTElucHV0RWxlbWVudD50aGlzLmZvcm0ucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gICAgICAgIGhpZGRlbklucHV0SWRBZGRyZXNzLnZhbHVlID0gYWRkcmVzcyA/IGFkZHJlc3NbaWRBZGRyZXNzS2V5XSA6ICcnO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBpbml0QWRkcmVzc2VzRGF0YSgpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IHRoaXMuZ2V0QXR0cmlidXRlKCdhZGRyZXNzZXMnKTtcbiAgICAgICAgdGhpcy5hZGRyZXNzZXNEYXRhT2JqZWN0ID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIGEgcXVlcnlTZWxlY3RvciBuYW1lIG9mIHRoZSBmb3JtIGVsZW1lbnQuXG4gICAgICovXG4gICAgZ2V0IGZvcm1TZWxlY3RvcigpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGUoJ2Zvcm0tc2VsZWN0b3InKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIGEgcXVlcnlTZWxlY3RvciBuYW1lIG9mIHRoZSBhZGRyZXNzIHNlbGVjdCBlbGVtZW50cy5cbiAgICAgKi9cbiAgICBnZXQgZGF0YVNlbGVjdG9yKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEF0dHJpYnV0ZSgnZGF0YS1zZWxlY3RvcicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgYSBxdWVyeVNlbGVjdG9yIG5hbWUgb2YgYSBoaWRkZW4gZGVmYXVsdCBhZGRyZXNzIGlucHV0LlxuICAgICAqL1xuICAgIGdldCBkZWZhdWx0QWRkcmVzc1NlbGVjdG9yKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEF0dHJpYnV0ZSgnZGVmYXVsdC1hZGRyZXNzLXNlbGVjdG9yJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyBhIHF1ZXJ5U2VsZWN0b3IgbmFtZSBvZiBhIGhpZGRlbiBjdXN0b21lciBpZCBpbnB1dC5cbiAgICAgKi9cbiAgICBnZXQgYWRkcmVzc0hpZGRlbklucHV0U2VsZWN0b3IoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QXR0cmlidXRlKCdhZGRyZXNzLWhpZGRlbi1pbnB1dC1zZWxlY3RvcicpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgYSBxdWVyeVNlbGVjdG9yIG5hbWUgb2YgYSBoaWRkZW4gY29tcGFueSB1bml0IGlkIGlucHV0LlxuICAgICAqL1xuICAgIGdldCBjb21wYW55QWRkcmVzc0hpZGRlbklucHV0U2VsZWN0b3IoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QXR0cmlidXRlKCdjb21wYW55LWFkZHJlc3MtaGlkZGVuLWlucHV0LXNlbGVjdG9yJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyBhIHF1ZXJ5U2VsZWN0b3IgbmFtZSBvZiBhIGhpZGRlbiBzaGlwcGluZyBjdXN0b21lciBpZCBpbnB1dC5cbiAgICAgKi9cbiAgICBnZXQgc2hpcHBpbmdBZGRyZXNzSGlkZGVuSW5wdXRTZWxlY3RvcigpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGUoJ3NoaXBwaW5nLWFkZHJlc3MtaGlkZGVuLWlucHV0LXNlbGVjdG9yJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyBhIHF1ZXJ5U2VsZWN0b3IgbmFtZSBvZiBhIGhpZGRlbiBzaGlwcGluZyBjdXN0b21lciBpZCBpbnB1dC5cbiAgICAgKi9cbiAgICBnZXQgc2hpcHBpbmdDb21wYW55QWRkcmVzc0hpZGRlbklucHV0U2VsZWN0b3IoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QXR0cmlidXRlKCdzaGlwcGluZy1jb21wYW55LWFkZHJlc3MtaGlkZGVuLWlucHV0LXNlbGVjdG9yJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cyBpZiB0aGUgc3BsaXQgZGVsaXZlcnkgZm9ybSBpcyBkZWZpbmVkLlxuICAgICAqL1xuICAgIGdldCBvcHRpb25WYWx1ZURlbGl2ZXJUb011bHRpcGxlQWRkcmVzc2VzKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEF0dHJpYnV0ZSgndG9nZ2xlLW9wdGlvbi12YWx1ZScpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgYSBxdWVyeVNlbGVjdG9yIG5hbWUgb2YgdGhlIHNoaXBwaW5nIGFkZHJlc3Mgc2VsZWN0IGVsZW1lbnQuXG4gICAgICovXG4gICAgZ2V0IHNoaXBwaW5nQWRkcmVzc1RvZ2dsZXJTZWxlY3RvcigpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRBdHRyaWJ1dGUoJ3NoaXBwaW5nLWFkZHJlc3MtdG9nZ2xlci1zZWxlY3RvcicpO1xuICAgIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=